# Bookstore API

Тестовое задание для обучающихся Go: Система управления библиотекой
Разработайте REST API на Go для управления коллекцией книг и авторами,
которые их пишут. API будет выполнять операции CRUD с книгами и авторами,
хранящимися в базе данных PostgreSQL. Система должна быть
контейнеризирована с помощью Docker, состоящего из двух отдельных
контейнеров: одного для веб-приложения и одного для базы данных.

## Структура проекта

- `cmd/main.go`: Главный файл приложения.
- `pkg/handlers/handlers.go`: обработчики HTTP-запросов.
- `pkg/handlers/routes.go`: маршрутизация.
- `pkg/handlers/json_handlers`: вспомогательные функции для обработки запроса/ответа/возвращения ошибок
- `pkg/models`: Модели для работы с json
- `pkg/repository`: Подключение и работа с базой данных
- `first_init_db`: SQL файлы для первой инициализации БД.
- `.env`: конфиг для локальной работы и дебага HTTP сервера, докер БД надо поднять.
- `.env_for_docker`: конфиг для работы HTTP сервера из докера, БД из докера.
- `Dockerfile`: Инструкции для сборки Docker-образа.
- `docker-compose.yml`: Конфигурация Docker Compose.

## Требования

- golang:latest
- Docker Desktop
- Postman

## Инструкции по сборке и запуску

### локальный старт, для отладки, HTTP сервера + Postgres в изолированном контейнере
docker-compose --project-name="final_web" up -d --build
ждете когда "pg-container" (image Postgres) будет в статусе "Running" и НЕ важно какой статус у "web-container"
подключение к БД: postgresql://127.0.0.1:50000/pgdb

go run main.go

### старт HTTP сервера + Postgres в связанных контейнерах
docker-compose --project-name="final_web" up -d --build
ждете когда "pg-container" (image Postgres) будет в статусе "Running и важно что бы статус у "web-container" также был "Running"

## Реализованы Api
###  Для книг:

GET /books — Получить все книги
Пример: http://127.0.0.1:50001/books

GET /books/{id} — Получить книгу по ее идентификатору;
Пример: http://127.0.0.1:50001/books/1

POST/books — Добавить новую книгу;
Пример: http://127.0.0.1:50001/books
  {
    "title" : "Книга 2024",
    "author_id" : 1,
    "year": 2024,
    "isbn": "123-456-789-1011"
  }

PUT /books/{id} — обновить книгу по ее идентификатору;
Пример: http://127.0.0.1:50001/books/5
  {
    "title" : "Книга 2024 часть 1",
    "author_id" : 1,
    "year": 2024,
    "isbn": "123-456-789-1011"
  }

DELETE /books/{id} — Удалить книгу по ее идентификатору.
Пример: http://127.0.0.1:50001/books/5

### Для авторов:

GET /authors — Получить всех авторов;
Пример: http://127.0.0.1:50001/authors

GET /authors/{id} — получить автора по его идентификатору;
Пример: http://127.0.0.1:50001/authors/1

POST/authors — Добавить нового автора;
Пример: http://127.0.0.1:50001/authors
  {
  "name": "Имя писателя",
  "sirname": "Фамилия писателя",
  "biography": "Биография писателя",
  "birthday": "2024-01-01"
  }

PUT /authors/{id} — обновить автора по его идентификатору;
Пример: http://127.0.0.1:50001/authors/3
Пример тела обращения:
  {
  "name": "Имя писателя, точно имя",
  "sirname": "Фамилия писателя, не имя",
  "biography": "Биография писателя, тут",
  "birthday": "2024-01-01"
  }

DELETE /authors/{id} — удалить автора по его идентификатору.
Пример: http://127.0.0.1:50001/authors/3

###    Обновление информации по книге и по автору:

PUT /books/{book_id}/authors/{author_id} - одновременное обновление информации по книге и по автору
Пример: http://127.0.0.1:50001/books/9/authors/4
{
"book":
  {
    "title" : "Книга 2024",
    "author_id" : 1,
    "year": 2024,
    "isbn": "123-456-789-1011"
  },

  "author":
  {
  "name": "Имя писателя, точно имя",
  "sirname": "Фамилия писателя, не имя",
  "biography": "Биография писателя, тут",
  "birthday": "2024-01-01"
  }
}